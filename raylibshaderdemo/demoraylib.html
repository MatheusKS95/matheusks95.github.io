<!doctypehtml>
<html lang=EN-us>
	<head>
		<meta charset=utf-8>
		<meta content="text/html; charset=utf-8"http-equiv=Content-Type>
		<title>Demo - Raylib e shaders</title>
		<meta content="raylib web game"name=title>
		<meta content="New raylib web videogame, developed using raylib videogames library"name=description>
		<meta content="raylib, programming, examples, html5, C, C++, library, learn, games, videogames"name=keywords>
		<meta content="width=device-width"name=viewport>
		<meta content=website property=og:type>
		<meta content="raylib web game"property=og:title>
		<meta content=image/png property=og:image:type>
		<meta content=https://www.raylib.com/common/raylib_logo.png property=og:image>
		<meta content="New raylib web videogame, developed using raylib videogames library"property=og:image:alt>
		<meta content="raylib - example"property=og:site_name>
		<meta content=https://www.raylib.com/games.html property=og:url>
		<meta content="New raylib web videogame, developed using raylib videogames library"property=og:description>
		<meta content=summary_large_image name=twitter:card>
		<meta content=@raysan5 name=twitter:site>
		<meta content="raylib web game"name=twitter:title>
		<meta content=https://www.raylib.com/common/raylib_logo.png name=twitter:image>
		<meta content="New raylib web videogame, developed using raylib videogames library"name=twitter:image:alt>
		<meta content=https://www.raylib.com/games.html name=twitter:url>
		<meta content="New raylib web videogame, developed using raylib videogames library"name=twitter:description><link href=https://www.raylib.com/favicon.ico rel="shortcut icon">
		<style>
			* { margin: 0; padding: 0; box-sizing: border-box; }

			body {
			  background: #000000;
			  color: #eeffee;
			  font-family: "Fira Code", monospace;
			  display: flex;
			  flex-direction: column;
			  min-height: 100vh;
			  padding: 1rem;
			}

			header {
			  border-bottom: 2px solid #eeffee;
			  margin-bottom: 2rem;
			  padding-bottom: 1rem;
			}

			.typing {
			  font-size: clamp(1.5rem, 4vw, 2.5rem);
			  white-space: nowrap;
			  overflow: hidden;
			  border-right: 2px solid #eeffee;
			  width: 0;
			  animation: typing 3s steps(30, end) forwards, blink 0.7s infinite;
			}

			@keyframes typing {
			  from { width: 0; }
			  to { width: 100%; }
			}

			@keyframes blink {
			  0%, 100% { border-color: transparent; }
			  50% { border-color: #eeffee; }
			}

			main {
			  width: 100%;
			  background: #111;
			  border: 1px solid #eeffee;
			  border-radius: 8px;
			  padding: 1rem;
			}

			h2 {
			  margin-bottom: 0.5rem;
			}

			a {
			  color: #eeffee;
			  text-decoration: none;
			  border-bottom: 1px dashed #eeffee;
			}

			a:hover {
			  color: #0c0c0c;
			  background: #eeffee;
			}

			footer {
			  border-top: 2px solid #eeffee;
			  text-align: center;
			  padding: 1rem;
			  margin-top: 2rem;
			  font-size: 0.9rem;
			}
			canvas.emscripten
			{
				border:0 none;
				background-color:#000;
				width: 100%;
			}
			.code-box {
				border: 1px solid #ccc;
				padding: 15px;
				background-color: #001100;
				margin: 20px;
				font-family: monospace;
				white-space: pre-wrap;
				word-wrap: break-word;
			}

			.code-box pre {
				margin: 0; /* Remove default margin from <pre> */
			}

			.code-box code {
				display: block; /* Ensures <code> takes up full width of <pre> */
				color: #fff;
			}
		</style>
		<script src=https://cdn.jsdelivr.net/gh/eligrey/FileSaver.js/dist/FileSaver.min.js></script>
		<script>function saveFileFromMEMFSToDisk(e,a){var i,o=FS.readFile(e);i=new Blob([o.buffer],{type:"application/octet-binary"}),saveAs(i,a)}</script>
		
		</head>
		<header>
			<div class="typing"><a href="../index.html">/> Olá, eu sou Matheus Schaefer — Desenvolvedor</a></div>
		</header>
		<body>
			<p>Exemplo simples de um app feito em C com a Raylib, compilado com Emscripten para web. Código parcial abaixo da viewport.</p>
			<canvas class=emscripten id=canvas oncontextmenu=event.preventDefault() tabindex=-1></canvas>
			<p id=output>
				<script>var Module={print:function(){var e=document.getElementById("output");return e&&(e.value=""),function(n){arguments.length>1&&(n=Array.prototype.slice.call(arguments).join(" ")),console.log(n),e&&(e.value+=n+"\n",e.scrollTop=e.scrollHeight)}}(),canvas:document.getElementById("canvas")}</script>
				<script src=demoraylib.js async></script>
		<br><br>
		<div class="code-box">
        <pre><code>
/*
 * Copyright (C) 2025 Matheus Klein Schaefer
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, version 3.
 *
 * This program is distributed in the hope that it will be useful, but
 * WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see <https://www.gnu.org/licenses/>.
 */

#include "raylib.h"

#if defined(PLATFORM_WEB)
#define CUSTOM_MODAL_DIALOGS          
#include <emscripten/emscripten.h>
#endif

static const char *vs = "#version 100\n"
	"attribute vec3 vertexPosition;\n"
	"attribute vec2 vertexTexCoord;\n"
	"uniform mat4 mvp;\n"
	"uniform vec2 uResolution;\n"
	"varying vec3 FragPos;\n"
	"varying vec2 TexCoord;\n"
	"void main()\n"
	"{\n"
	"	vec4 clip_pos = mvp * vec4(vertexPosition, 1.0);\n"
	"	vec3 ndc = clip_pos.xyz / clip_pos.w;\n"
	"	vec2 screen_pos = (ndc.xy * 0.5 + 0.5) * uResolution;\n"
	"	screen_pos = floor(screen_pos) + 0.5;\n"
	"	vec2 ndc_q = (screen_pos / uResolution) * 2.0 - 1.0;\n"
	"	vec2 clip_xy_q = ndc_q * clip_pos.w;\n"
	"	FragPos  = vertexPosition;\n"
	"	TexCoord = vertexTexCoord;\n"
	"	gl_Position = vec4(clip_xy_q, clip_pos.z, clip_pos.w);\n"
	"}\n"
	"\0";

static const char *fs = "#version 100\n"
	"precision mediump float;\n"
	"varying vec3 FragPos;\n"
	"varying vec2 TexCoord;\n"
	"uniform sampler2D diffuse;\n"
	"uniform vec4 colDiffuse;\n"
	"void main()\n"
	"{\n"
	"	vec4 texel = texture2D(diffuse, TexCoord);\n"
	"	gl_FragColor = texel * colDiffuse;\n"
	"}\n"
	"\0";

void UpdateDrawFrame(void);

Model model;

Camera camera = { 0 };

int main(void)
{
	const int screenWidth = 640;
	const int screenHeight = 480;

	InitWindow(screenWidth, screenHeight, "Shader demo");

	camera.position = (Vector3){ 5.0f, 5.0f, 5.0f };
	camera.target = (Vector3){ 0.0f, 0.0f, 0.0f };
	camera.up = (Vector3){ 0.0f, 1.0f, 0.0f };
	camera.fovy = 45.0f;
	camera.projection = CAMERA_PERSPECTIVE;

	Shader shader = LoadShaderFromMemory(vs, fs);
	int resloc = GetShaderLocation(shader, "uResolution");
	float res[2] = {screenWidth, screenHeight};
	SetShaderValue(shader, resloc, res, SHADER_UNIFORM_VEC2);
	
	model = LoadModel("assets/cube.m3d");
	Texture texture = LoadTexture("assets/tile.qoi");
	for(int i = 0; i < model.materialCount; i++)
	{
		model.materials[i].shader = shader;
		model.materials[i].maps[MATERIAL_MAP_DIFFUSE].texture = texture;
	}

	emscripten_set_main_loop(UpdateDrawFrame, 60, 1);

	CloseWindow();

	return 0;
}

void UpdateDrawFrame(void)
{
	UpdateCamera(&camera, CAMERA_ORBITAL);
	BeginDrawing();
		ClearBackground(BLACK);
		BeginMode3D(camera);
			DrawModel(model, (Vector3){ 0 }, 1.0f, WHITE);
		EndMode3D();
		DrawFPS(10, 10);
	EndDrawing();
}

        </code></pre>
    </div>
		</body>
</html>
